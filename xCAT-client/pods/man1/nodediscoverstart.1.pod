=head1 NAME

B<nodediscoverstart> - starts the node discovery process

=head1 SYNOPSIS

B<nodediscoverstart> [-h| --help | -v | --version]

B<Sequential Discovery Specific:>

=over 2

B<nodediscoverstart> noderange=<noderange> [hostiprange=<imageprofile>] [bmciprange=<bmciprange>] [groups=<groups>] [rack=<rack>] [chassis=<chassis>] [height=<height>] [unit=<unit>]

=back

B<Profile Discovery Specific:>

=over 2

B<nodediscoverstart> networkprofile=<network-profile> imageprofile=<image-profile> hostnameformat=<nost-name-format> [hardwareprofile=<hardware-profile>] [groups=<node-groups>] [rack=<rack-name>] [chassis=<chassis-name>] [height=<rack-server-height>] [unit=<rack-server-unit-location>] [rank=rank-num]

=back

=head1 DESCRIPTION

The B<nodediscoverstart> command starts the node discovery process. 

The B<Sequential Discovery> and B<Profile Discovery> can NOT be run parallelly. 

B<Sequential Discovery Specific:>

=over 2

The B<Sequential Discovery> is the simplest discovery approach that only specifying the B<noderange>, B<hostiprange> and B<bmciprange> could start the discovery process. 

I<noderange> argument must be specified to start the B<Sequential Discovery>.

If you want to predefine host ip and bmc ip for the nodes, the arguments B<hostiprange> and B<bmciprange> could be ignored.

A free node name from the noderange will be assigned to a new discovered node. If the free node has the host ip or bmc ip predefined, the predefined ip will be used, otherwise a free host ip or bmc ip will be selected from the hostiprange or bmciprange.

Using the '-V' to display the free node names, ips list.

=back

B<Profile Discovery Specific:>

=over 2

The B<Profile Discovery> is the PCM associated discovery approach.

I<networkprofile>, I<imageprofile>, I<hostnameformat> arguments must be specified to start the B<Profile Discovery>.

All nodes discovered by this process will be associated with specified profiles and rack/chassis/unit locations.

=back

You can PXE boot nodes that you want to provision. PXE booting nodes launches the node discovery process. During the node discovery process, nodes are discovered automatically. Node settings are assigned automatically according to the specified profiles

After the nodes are discovered, their configuration files are updated automatically. Configuration files include the /etc/hosts service file, DNS configuration, and DHCP configuration. Kit plug-ins are automatically triggered to update kit related configurations and services.

=head1 OPTIONS

B<-h|--help>

Display usage message.

B<-v|--version>

Command Version.

B<-V|--verbose>

Display the free node names and host/bmc ips.

B<noderange=<noderange>>

The mandatory argument to start the B<Sequential Discovery>. The valid format is xCAT B<noderange>. e.g. node[01-10].

B<hostiprange=<ip range>>

The ip range which will be assigned to the host of new discovered node. The format could be: B<start_ip-end_ip> or B<noderange>. e.g. 192.168.0.1-192.168.0.10 or 192.168.0.[1-10].

B<bmciprange=<ip range>>

The ip range which will be assigned to the bmc of new discovered node. The format could be: B<start_ip-end_ip> or B<noderange>. e.g. 192.168.1.1-192.168.1.10 or 192.168.1.[1-10].

B<imageprofile=<image-profile>>

Sets the new image profile name used by the node, where <image-profile> is the new image profile.  An image profile defines the provisioning method, OS information, kit information, and provisioning parameters for a node. If the "__ImageProfile_imgprofile" group already exists in the nodehm table, then "imgprofile" is used as the image profile name.

B<networkprofile=<network-profile>>

Sets the new network profile name used by the node, where <network-profile> is the new network profile. A network profile defines the network, NIC, and routes for a node. If the "__NetworkProfile_netprofile" group already exists in the nodehm table, then "netprofile" is used as the network profile name.

B<hardwareprofile=<hardware-profile>>

Sets the new hardware profile name used by the node, where <hardware-profile> is the new hardware management profile used by the node. If a "__HardwareProfile_hwprofile" group exists, then "hwprofile" is the hardware profile name. A hardware profile defines hardware management related information for imported nodes, including: IPMI, HMC, CEC, CMM.

B<hostnameformat=<nost-name-format>>

Sets the node name format for all nodes discovered, where <node-name-format> is a supported format. The two types of formats supported are prefix#NNNappendix and prefix#RRand#NNappendix, where wildcard #NNN and #NN are replaced by a system generated number that is based on the provisioning order. Wildcard #RR represents the rack number and stays constant.

For example, if the node name format is compute-#NN, the node name is generated as: compute-00, compute-01, ..., compute-99. If the node name format is blade#NNN-x64, the node name is generated as: blade001-x64, blade002-x64, ..., blade999-x64

For example, if the node name format is compute-#RR-#NN and the rack number is 2, the node name is generated as: compute-02-00, compute-02-01, ..., compute-02-99. If node name format is node-#NN-in-#RR and rack number is 1, the node name is generated as: node-00-in-01, node-01-in-01, ..., node-99-in-01

B<groups=<node-groups>>

Sets the node groups that the imported node belongs to, where <node-group> is a comma-separated list of node groups.

B<rack=<rack-name>> 

Sets the rack name, where <rack-name> is the rack the node is located on or placed into.
 
B<chasiss=<chassis-name>>

Sets the chassis name, where <chassis-name> is the chassis that the Blade server or PureFlex sysstem is located. This option is used for the Blade server and PureFlex system only. You cannot specify this option with the rack option.

B<height=<rack-server-height>>

Sets the height of a rack server, where <rack-server-height> is the server height. You must specify the this option with the rack option. If the rack option is not specified, the default value is 1.

B<unit=<rack-server-unit-location>>

Sets the start unit value for the node, where <rack-server-unit-location> is the location of the starting rack. This option is for a rack server only. You must specify this option with the rack option. If the unit option is not specified, the default value is 1

B<rank=<rank-num>>

Specifies the starting rank number that is used in the node name format, where <rack-num> is a valid integer between 0 and 254. This option must be specified with nodenameformat option. For example, if your node name format is compute-#RR-#NN. The rack's number is 2 and rank is specified as 5, the node name is generated as follows: compute-02-05, compute-02-06, ..., compute-02-99.

=head1 RETURN VALUE

0  The command completed successfully.

1  An error has occured.

=head1 EXAMPLES

=over 3

=item 1

B<Sequential Discovery>: To discover nodes with noderange and host/bmc ip range:

B<nodediscoverstart> noderange=n[1-10] hostiprange='172.20.101.1-172.20.101.10' bmciprange='172.20.102.1-172.20.102.10' -V

 Sequential Discovery: Started:
    Number of free node names: 10
    Number of free host ips: 10
    Number of free bmc ips: 10
 ------------------------------------Free Nodes------------------------------------
 NODE                HOST IP             BMC IP
 n01                 172.20.101.1        172.20.102.1
 n02                 172.20.101.2        172.20.102.2
 ...                 ...                 ...

=item 2

B<Profile Discovery>: To discover nodes using the default_cn network profile and the rhels6.3_packaged image profile, use the following command:

B<nodediscoverstart> networkprofile=default_cn imageprofile=rhels6.3_packaged hostnameformat=compute#NNN

=back

=head1 SEE ALSO

L<nodediscoverstop(1)|nodediscoverstop.1>, L<nodediscoverls(1)|nodediscoverls.1>, L<nodediscoverstatus(1)|nodediscoverstatus.1>

